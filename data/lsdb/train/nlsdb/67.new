<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">	
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="keywords" content="" />
	<link rel="stylesheet" type="text/css" media="screen,projection" href="/css/main.css" />
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/css/labs.css" />
	<link rel="stylesheet" type="text/css" media="screen,projection" href="/css/navbar.css" />
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/css/menu.css" />
    <link rel="stylesheet" type="text/css" media="print" href="/css/print.css" />
    <!--[if lt IE 7]>
	<link rel="stylesheet" type="text/css" href="/css/ie.css">
	<![endif]-->	
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<script src="/j/AC_RunActiveContent.js" type="text/javascript"></script>	
<script type="text/javascript" src="/j/mootools.r598.js"></script>
<script type="text/javascript" src="/j/mootools.bgiframe.js"></script>
<script type="text/javascript" src="/j/navbar.js"></script>
<script type="text/javascript">
window.addEvent('domready', function() {
	new navbar($E('ul.nav'), {
		bgiframe: false,
		delay: 500,
		animate: {
			props: ['opacity', 'width', 'height'],
			opts: {
				duration:400,
				fps: 100,
				transition: Fx.Transitions.Cubic.easeOut
			}
		}
	});

	});
</script><title>Terry Furey Lab - Projects &amp; Collaborations - Institute for Genome Sciences &amp; Policy</title>
</head>
<body>
<div id="shadow-bg">
<div id="wrap">

<div id="header">
<a href="/" title="Duke Institute for Genome Sciences &amp; Policy" id="logo"><img src="/i/logo.png" alt="Duke Institute for Genome Sciences &amp; Policy" /></a>
<div id="inline-nav">
<p><a href="http://calendar.duke.edu/cal/main/setViewPeriod.do?b=de&amp;viewType=monthView&amp;setappvar=group(agrp_InstituteforGenomeSciencesandPolicy)&amp;date=20100201">Events Calendar</a> | <a href="/about/contact-us.php">Contact Us</a> | <a href="/sitemap/">Site Map</a></p>
</div>
<div id="header-nav">
<p><a href="http://twitter.com/DukeIGSP">Follow our Tweets</a><img src="/i/bullet_header01.gif" alt="bullet" class="inline" /></p> 
<p><a href="http://www.genomestohealth.org">Genomes to Health</a><img src="/i/bullet_header02.gif" alt="bullet" class="inline" /></p>
<p><a href="/hhmi/">IGSP-HHMI Program</a><img src="/i/bullet_header03.gif" alt="bullet" class="inline" /></p> 
</div>		<!--End header-nav-->
<form action="http://www.genome.duke.edu/search/" id="searchbox_018110843849616161307:c7fkkfpm0uy">
<div id="search">
	 <input type="hidden" name="cx" value="018110843849616161307:c7fkkfpm0uy" />     
     <input type="hidden" name="cof" value="FORID:11;NB:1" />
     <input type="text" name="q" size="20" id="q" />
     <input type="image" src="/i/btn.gif" name="sa" value="Search" class="submit" />
</div>
</form>

</div>		<!--End header-->
	<div id="horiz-menu">
		<div class="wrapper">			
				<div class="navBG">
					<ul class="nav">
					    <li ><a class="topdaddy" href="/about/">About the Institute</a>
						<ul>
						<li><a href="/about/message-from-the-director.php">Message from the Director</a></li>
						<li><a href="/about/mission.php">Mission Statement</a></li>
                        <li><a href="/documents/pdf/strategicplan.pdf">IGSP Strategic Plan</a></li>
   						<li><a href="/about/membership.php">Membership</a></li>
                        <li><a href="/documents/pdf/IGSP bylaws Adopted March 2010.pdf">IGSP By-laws</a></li>
						<li><a href="/about/contact-us.php">Directions</a></li>
						<li><a href="/about/getting-involved.php">Getting Involved</a></li>	
						</ul>
						</li>
						<li ><a class="topdaddy" href="/research/programs/">Areas of Research</a>
						<ul>
						<li><a class="daddy" href="/research/biology-genomes/">Biology of Genomes</a>
                        	<ul>
                            <li><a href="/centers/csb/">Systems Biology</a></li>
                            <li><a href="/centers/ceg/">Evolutionary Genomics</a></li>
                            <li><a href="/CBB/">Computational Biology</a></li>
                        	</ul>
                        </li>    
                        <li><a class="daddy" href="/research/genomics-health/">Genomics and Health</a>
                        	<ul>
                            <li><a href="/centers/cgm/">Genomic Medicine</a></li>
                            <li><a href="/centers/cagt/">Applied Genomics</a></li>
                            <li><a href="/research/">Genomics and Psychology</a></li>
                        	</ul>
                        </li>    
                        <li><a href="http://www.genome.duke.edu/centers/gelp/">Genomes and Society</a></li>
                  	    <li><a href="http://www.genome.duke.edu/centers/pg2/">Human Genome Variation</a></li>
                        <li><a href="/research/">Faculty Research Areas</a></li>					
                        <li><a href="/education/undergraduate/opportunities/">Undergraduate Research</a></li>
						</ul>
						</li>						
						<li ><a class="topdaddy" href="/education/">Education</a>
						<ul>
                       	<li><a class="daddy" href="/education/seminars/">Seminars</a>
							<ul>
                            <li><a href="http://people.genome.duke.edu/~nevin001/Meetings/CancerGenomics/">Cancer Genomics</a></li>
                            <li><a href="/CBB/compbioseminar/">Computational Biology</a></li>
                            <li><a href="/education/communicate/">Communications Series</a></li>
                            <li><a href="/education/seminars/genomes4/">Genomes@4</a></li>
                            <li><a href="/education/genomeacademy/">Genome Academy</a></li>
                            <li><a href="/education/seminars/genome-biology/">Genome Biology</a></li>
                            <li><a href="/centers/cgm/forum-schedule/">Genomic Medicine</a></li>
                            <li><a href="/education/seminars/journal-club/">Journal Club</a></li>
                            <li><a href="/centers/csb/seminars/">Systems Biology</a></li>
							<li><a href="http://upg.duke.edu/seminars/tuesdayseminars.html">Tuesday Seminar Series</a></li>						
							</ul>
						</li>
						<li><a href="/education/undergraduate/">Undergraduate Programs</a></li>							
						<li><a class="daddy" href="/education/graduate/">Graduate Programs</a>
							<ul>
							<li><a href="/education/graduate/upgg/">Genetics &amp; Genomics</a></li>
							<li><a href="/CBB/">Computational Biology</a></li>
							</ul>
						</li>
						<li><a class="daddy" href="/education/postdoctoral/">Post Doctoral Programs</a>
							<ul>
							<li><a href="/education/postdoctoral/dukescholars/">Genomic Meds Scholars</a></li>
							<li><a href="/education/postdoctoral/evolutionary/">Evolutionary Genomics</a></li>
							<li><a href="/education/postdoctoral/hemoglobinopathies/">Hemoglobinopathies</a></li>
							</ul>
						</li>
						<li><a href="/education/workshops/">Workshops</a></li>
						<li><a href="/education/courses/">Genome Courses</a></li>
						</ul>
						</li>
						<li ><a class="topdaddy" href="/resources/">Resources</a>
						<ul>
                        <li><a href="http://data.genome.duke.edu/">Gene Expression Datasets</a></li>
						<li><a href="http://dig.genome.duke.edu/software.html">Software</a></li>
						<li><a href="/resources/business/">Business &amp; Funding Data</a></li>
						<li><a href="/cores/computational/">Computational Resources</a></li>
						</ul>
						</li>
						<li ><a class="topdaddy" href="/press/">Press &amp; Publications</a>
						<ul>
						<li><a href="/press/news/">News</a></li>
						<li><a href="/press/Op-Eds/">Opinions &amp; Editorials</a></li>
						<li><a href="/press/genomelife/"><em>GenomeLife</em> Magazine</a></li>	
                        <li><a href="/newsletter/"><em>Genomes@Duke</em> Newsletter</a></li>
   						<li><a href="/books/">Books by IGSP Authors</a></li>	
						</ul>
						</li>
						<li ><a class="topdaddy" href="/people/">Directory</a>
						<ul>
						<li><a href="/people/faculty/">Faculty Directory</a></li>
                        <li><a href="/research/">Faculty Research Areas</a></li>
						<li><a href="/people/administration/">Central Administration</a></li>                        
						</ul>
						</li>
                        <li ><a class="topdaddy" href="/interactive/">Interactive</a>
						<ul>
                        <li><a href="http://www.facebook.com/genome.duke">Facebook</a></li>
                        <li><a href="http://deimos3.apple.com/WebObjects/Core.woa/Browse/new.duke.edu.1301444505">iTunes U</a></li>
                        <li><a href="http://twitter.com/DukeIGSP">Twitter</a></li>                        
                        <li><a href="http://www.youtube.com/DukeIGSP">YouTube</a></li>
						<li><a href="/interactive/multimedia/">Multimedia</a></li>
						</ul>
						</li>													
					</ul>								
				</div>		
		</div>
	</div>	<!--End horiz-menu-->
<div id="divider"></div>
	
<div id="content">
<div id="mainContentLong">
<p class="breadcrumbs"><a href="/index.php">IGSP Home</a> &raquo; <a href="/labs/index.php">Labs</a> &raquo; <a href="/labs/furey/index.php">Furey</a> &raquo; <a href="/labs/furey/software/index.php">Software</a> &raquo; Fseq </p><!--DO NOT CHANGE EDIT ANYTHING ABOVE THIS LINE EXCEPT FOR TITLE TAG-->

<!--<h1>Terry Furey's Research Group</h1>-->
<h1>Research Software</h1>
<h2>F-Seq: A Feature Density Estimator for High-Throughput Sequence Tags</h2>

<p>Tag sequencing using high-throughput sequencing technologies are now regularly employed to identify specific sequence features such as transcription factor binding sites (ChIP-seq) or regions of open chromatin (DNase-seq).  To intuitively summarize and display individual sequence data as an accurate and interpretable signal, we developed F-Seq, a software package that generates a continuous tag sequence density estimation allowing identification of biologically meaningful sites whose output can be displayed directly in the UCSC Genome Browser.</p>

<pre>
F-Seq Version 1.81
usage: fseq [options]... [file(s)]...
 -b &lt;background dir&gt;     background directory (default=none)
 -d &lt;input dir&gt;          input directory (default=current directory)
 -f &lt;arg&gt;                fragment size (default=estimated from data)
 -h                      print usage
 -l &lt;arg&gt;                feature length (default=600)
 -o &lt;output dir&gt;         output directory (default=current directory)
 -of &lt;wig | bed | npf&gt;   output format (default wig)
 -p &lt;ploidy dir&gt;         ploidy/input directory (default=none)
 -s &lt;arg&gt;                wiggle track step (default=1)
 -t &lt;arg&gt;                threshold (standard deviations) (default=4.0)
 -v                      verbose output
Note: DNase HS data (5' ends) - set -f 0
</pre>

<p>
Newest version (1.82): <a href="fseq.1.82.tgz">Download</a>
</p>

<p>
Bioinformatics paper version: <a href="fseq.1.0.tar">Download</a>
</p>

<p>
Source available: <a href="fseq_source.tgz">Download</a>
</p>

<h2>Software requirements</h2>
<p>
This software requires Java version 1.5 or greater.  <br>
To see your version of java (or if it is installed), type 'java -version'<br><br>

If java is not installed or you do not have the correct version, download  
<a href="http://java.sun.com/javase/downloads/index.jsp">here</a>.<br>
<br>
Current accepted input formats:<br>
<a href="http://genome.ucsc.edu/FAQ/FAQformat#format1">Bed</a><br><br>

Currently accepted output formats:<br>
<a href="http://genome.ucsc.edu/FAQ/FAQformat#format6">Wiggle</a><br>
<a href="http://genome.ucsc.edu/FAQ/FAQformat#format1">Bed</a><br>
<a href="http://encodewiki.ucsc.edu/EncodeDCC/index.php/File_Formats#narrowPeak:_Narrow_.28or_Point-Source.29_Peaks_Format">narrowPeak</a><br>

<h2>narrowPeak: Narrow (or Point-Source) Peaks Format</h2>

<p>This format is used to provide called peaks of signal enrichment based on pooled, normalized (interpreted) data. It is a BED6+3 format.
</p>
<table cellpadding="5">

<tr>
<td> <b>field</b>       </td><td> <b>type</b> </td><td> <b>description</b>
</td></tr>
<tr>
<td> <i><b>chrom</b></i>       </td><td> string </td><td> Name of the chromosome

</td></tr>
<tr>
<td> <i><b>chromStart</b></i> </td><td> int </td><td> The starting position of the feature in the chromosome. The first base in a chromosome is numbered 0.
</td></tr>
<tr>
<td> <i><b>chromEnd</b></i> </td><td> int </td><td>  The ending position of the feature in the chromosome or scaffold. The chromEnd base is not included in the display of the feature. For example, the first 100 bases of a chromosome are defined as chromStart=0, chromEnd=100, and span the bases numbered 0-99.

</td></tr>
<tr>
<td> <i><b>name</b></i>        </td><td> string </td><td> Name given to a region (preferably unique).  Use '.' if no name is assigned.
</td></tr>
<tr>
<td> <i><b>score</b></i>       </td><td> int    </td><td> Indicates how dark the peak will be displayed in the browser (1-1000).  If '0', the DCC will assign this based on signal value. Ideally average signalValue per base spread between 100-1000.

</td></tr>
<tr>
<td> <i><b>strand</b></i>      </td><td> char  </td><td> +/- to denote strand or orientation (whenever applicable).  Use '.' if no orientation is assigned.
</td></tr>
<tr>
<td> <i><b>signalValue</b></i> </td><td> float  </td><td> Measurement of overall (usually, average) enrichment for the region.

</td></tr>
<tr>
<td> <i><b>pValue</b></i>      </td><td> float  </td><td> Measurement of statistical signficance (-log10). Use -1 if no pValue is assigned.
</td></tr>
<tr>
<td> <i><b>qValue</b></i>     </td><td> float  </td><td> Measurement of statistical significance using false discovery rate. Use -1 if no qValue is assigned.

</td></tr>
<tr>
<td> <i><b>peak</b></i>        </td><td> int    </td><td> Point-source called for this peak; 0-based offset from chromStart. Use -1 if no point-source called.
</td></tr></table>
<p>e.g.
</p>
<pre>chrX    9091548 9091648 .       0       .       182     5.0945  -1  50
chrX    9358722 9358822 .       0       .       91      4.6052  -1  40
chrX    9391082 9391182 .       0       .       182     9.2103  -1  75
</pre>

<br>
</p>
<h2>Usage in Linux</h2>
<p>
Make sure 'bin/fseq' is executable (chmod 0755 bin/fseq)<br>
<br>
For a list of options, type 'fseq -h'<br>
<br>
Example: fseq -v -of wig chr1.bed chr2.bed<br>

This takes as input the chr1.bed and chr2.bed files.
Will use verbose output and outputs the densities in the wiggle format.<br>

<br>
A perl script has been included which converts data from mapview format (MAQ alignment results) to BED format.<br>
</p>
<pre>
Usage:  mapviewToBed.pl &lt;MIN QUAL&gt; &lt;MAX_HITS&gt; &lt;FILE&gt;
        MIN_QUAL        = Exclude alignments with &lt;= this mapping quality score.
        MAX_HITS        = Exclude alignments with &gt; this number of hits.
        FILE            = Mapview file to convert.
</pre>
<p>
Example: perl mapviewToBed.pl 0 2 sequence.mapview<br>
This takes as input sequence.mapview, only uses sequences aligning in fewer than 2 locations with 0 or 1 mismatches, and only sequences with an alignment score of 0 or better.<br>

</p>

<h2>New Features</h2>
<p>
<b>Estimated fragment length.</b><br>
As F-seq was created initially for DNase-seq data, no shift based on fragment length was actually necessary and a simple command line procedure was used if the user wanted to shift sequence based on strand. To bring F-seq up to speed with other technologies, we implemented a method to determine the distance between positive and negative strand sequence densities using the Wilcoxon-Mann-Whitney Rank Sum Test. This test allows for a non-parametric estimate of the difference in positive-negative sequence distances from the expected value at 0 by ranking all possible positive-negative sequence differences and taking the median difference as the estimate. For practical reasons we limit the fragment shift to less than 500bp. This method also allows for calculating a confidence interval for the median distance but it has not been implemented.
</p>

<p>
<b>Strict enforcement of strand.</b><br>
In addition to fragment length estimation for shifting sequences based on strand, we have also decided to enforce strandedness. That is, one expects a fragment from ChIP-seq to only be available to be pulled down only if it is pointing toward the bound protein. Because of this, we assume that any other fragments are simply noise and they are discarded.
</p>

<p>
<b>Background model.</b><br>
The human genome contains a large amount of DNA that exists in multiple copies. To attempt to call peaks in regions which may exist more than once in the genome, we developed a background model which represents how many places a given sequence can align. We have generative alignability tracks by converting a set of all longest unique n-mers at each genomic position into alignment tracks for 20-mers (DNase) and 35-mers (all others). Anything that aligns more than four times is discarded by setting the background track to 0 at this position. The value at each position is then multiplied by the density estimate to correct for peaks that may be diluted by their sequences being placed in different genomic positions by MAQ which randomly assigns locations of reads which align in more than one place.
<br><br>
Background directory - This directory must contain a formatted .bff tracks which represents alignability across the genome.<br>
bff files for sequences of 20bp: <a href="unique20bp.tar.gz">Download</a><br>
bff files for sequences of 35bp: <a href="unique35bp.tar.gz">Download</a><br>
</p>

<p>
<b>Copy number / karyotype correction.</b><br>
Parallel to the issue of alignability in the genome is that of copy number variations. Copy number variations lead to regions of chromosomes being over-represented in the genomic DNA as compared to the genome build. These are especially problematic when performing analysis on cancer cell lines (eg. HelaS3 or K562). We want to remove the effect of regions by normalizing the signal based on a non-enriched input sample. To do this, an estimate of the copy depth of all sequences is computed by running a 10kb window across the aligned input sequences in the genome and comparing the sequence depth to the mean genomic sequencing depth. In a karyotypically normal cell line this value should be close to 1 for the entire genome. As copy number estimates for sequences increase, this value should reflect the actual sample copy number compared to the reference sequence. The Parzen density estimates are then divided by these values to correct for differences in DNase-seq or ChIP-seq data.
<br><br>
Ploidy directory - This directory must contain formatted .iff tracks which represent estimated ploidy information for the cell line of interest. Again, we will shortly provide the script to generate these tracks.<br>
iff files using 10kb windowing for GM12878: <a href="iffGM12878.tgz">Download</a><br>
iff files using 10kb windowing for K562: <a href="iffK562.tgz">Download</a><br>
iff files using 10kb windowing for HelaS3: <a href="iffHelaS3.tgz">Download</a><br>
iff files using 10kb windowing for HepG2: <a href="iffHepG2.tgz">Download</a><br>
<br>
To generate ploidy tracks, a series of wiggle files representing ploidy information for each chromsome should be converted into our iff format using <a href="iffBuilder.tgz">iffBuilder</a>. Each position should be a relative ploidy level (a normal cell line would have a 1 in each position). Ploidy level should be < 65.535.

<br>
<pre>
Usage: iffBuilder chr1.wig
Example wig input:
fixedStep chrom=chr22 start=14430371 step=1
0.0032
0.0032
0.0032
0.0032
0.0032

</pre>

</p>

<h2>Troubleshooting</h2>
<p>
A likely cause for errors is an "OutOfMemory" exception.  
To increase the available memory to the java virtual machine, edit
'bin/fseq' file and change the JAVA_OPTS property to increase the heap size.
</p>


</p>


<!--DO NOT EDIT ANYTHING BELOW THIS LINE-->
<p>&nbsp;</p>
<p>&nbsp;</p>
</div>		<!--End mainContent-->
</div>		<!--End content-->
<div id="cbbmenu">
<h2>Furey Lab</h2>
<ul>
	<li ><a href="/labs/furey/" title="Home">Home</a></li>
	<li ><a href="/labs/furey/projects/" title="Research &amp; Collaborations">Research &amp; Collaborations</a></li>
	<li ><a href="/labs/furey/software/" title="Research Software">Research Software</a></li> 
<!--	<li ><a href="/labs/furey/research/" title="Research &amp; Software">Research &amp; Software</a></li> -->
<!--	<li ><a href="/labs/furey/tools/" title="Tools &amp; Links">Tools &amp; Links</a></li> -->
	<li ><a href="/labs/furey/meetings/" title="Lab Meetings">Lab Meetings</a></li>
	<li ><a href="/labs/furey/publications/" title="Publications">Publications</a></li>
	<li ><a href="/labs/furey/courses/" title="Courses">Courses</a></li>
<!--	<li ><a href="/labs/furey/durham/" title="Duke &amp; Durham">Duke &amp; Durham</a></li> -->
    <li ><a href="/labs/furey/contact/" title="Contact">Contact</a></li>
</ul>
</div>		<!--End mainNav--><div id="footer">
<p>&copy; 2004-2010, Duke Institute for Genome Sciences &amp; Policy.&nbsp;&nbsp;&nbsp;&nbsp; <a href="http://www.duke.edu">Duke University</a> | <a href="http://www.dukemedicine.org/">Duke Medicine</a> | <a href="http://www.interdisciplinary.duke.edu/index.php">Interdisciplinary Studies at Duke</a></p>
</div>		<!--End footer-->

</div>		<!--End shadow-bg-->
</div>		<!--End wrap-->

</body>
</html>