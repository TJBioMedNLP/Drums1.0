<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
  <title>Max Planck Institut - Department of Genetics/Bioinformatics</title>
  <link href="../programmierung/ie.css" rel="stylesheet" type="text/css">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="expires" content="0">
  <meta name="author" content="Max Planck Gesellschaft e.V">
  <meta name="publisher" content="Max Planck Gesellschaft e.V">
  <meta name="copyright" content="Max Planck Gesellschaft e.V">
  <meta http-equiv="language" content="en">
  <meta name="keywords"
 content="Ibis, Improved base identification system, base caller, basecaller, base calling, Illumina, Solexa, Sequencing, Max, Planck, Max-Planck-Institut, Institut, Institute, Wissenschaft, Wissenschaften, Research, Evolutionary Anthropology, evolution&auml;re Anthropologie, Leipzig">
  <meta name="description"
 content="Ibis (Improved base identification system), an accurate, fast and easy-to use-base caller for the Illumina sequencing system. Ibis significantly reduces the error rate and increases the output of usable reads. Ibis is faster and makes fewer assumptions about chemistry and technology than other publicly available base calling packages such as AltaCyclic, BayesCall and Rolexa.">
  <meta name="page-topic" content="Science, Institute, Application">
  <meta name="audience" content="Alle">
  <meta name="robots" content="INDEX,FOLLOW">
  <script language="JavaScript" src="../programmierung/main.js"></script>
</head>
<body scroll="yes" topmargin="0" leftmargin="0" bottommargin="0"
 rightmargin="0" style="background-color: rgb(255, 255, 255);"
 marginheight="0" marginwidth="0">
<table bgcolor="#ffffff" border="0" cellpadding="0" cellspacing="0" width="100%">
  <tbody>
    <tr>
      <td colspan="3" height="1" width="100%"><img
 src="../bilder/pixel.gif" alt="" border="0" height="1" width="1"></td>
    </tr>
    <tr>
<!-- Platzhalter links --> <td height="605" valign="top" width="50%">
      <table bgcolor="#7ca6a6" border="0" cellpadding="0"
 cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td height="15" width="*"><img src="../bilder/pixel.gif" alt=""
 border="0" height="15" width="1"></td>
          </tr>
          <tr>
            <td bgcolor="#ffffff" height="111"><img
 src="../bilder/pixel.gif" alt="" border="0" height="1" width="1"></td>
          </tr>
          <tr>
            <td height="41" width="*"><img src="../bilder/pixel.gif" alt=""
 border="0" height="1" width="1"></td>
          </tr>
        </tbody>
      </table>
<!-- /Platzhalter links --> </td>
      <td align="center" valign="top"><!-- Metanavigation -->
      <table bgcolor="#ffffff" border="0" cellpadding="0"
 cellspacing="0" height="36" width="100%">
        <tbody>
          <tr>
            <td bgcolor="#7ca6a6" height="15" width="4"><img
 src="../bilder/pixel.gif" alt="" border="0" height="15" width="4"></td>
            <td width="1"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="1"></td>
            <td id="metanavi0" class="metanavi" bgcolor="#e6f2f2"
 width="140">&nbsp;<a href="http://www.eva.mpg.de/index.htm"
 class="metanavi" onmouseover="SpaltenFaerben('#C9DBD8','metanavi0')"
 onmouseout="SpaltenFaerben('#e6f2f2','metanavi0')" title="Home">MPI-HOME</a></td>
            <td width="1"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="1"></td>
            <td bgcolor="#e6f2f2" width="152"><img
 src="../bilder/pixel.gif" alt=""
 style="border: 0px solid ; width: 152px; height: 15px;"></td>
            <td width="1"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="1"></td>
            <td class="menu" bgcolor="#e6f2f2" width="466">
            <table align="right" border="0" cellpadding="0"
 cellspacing="0" height="15">
              <tbody>
                <tr>
                  <td id="adresse" bgcolor="#e6f2f2"><a
 href="http://www.eva.mpg.de/english/adresse.htm"
 onmouseover="SpaltenFaerben('#C9DBD8','adresse')"
 onmouseout="SpaltenFaerben('#E6F2F2','adresse')" onfocus="this.blur()"
 class="metanavi"><img src="../bilder/pixel.gif" alt="Contact" border="0"
 height="1" width="10">Contact<img src="../bilder/pixel.gif" alt=""
 border="0" height="1" width="10"></a></td>
                  <td class="metanavi" bgcolor="#999999" width="1"><img
 src="../bilder/pixel.gif" alt="" border="0" height="1" width="1"></td>
                  <td id="imprint" bgcolor="#e6f2f2"><a
 href="http://www.eva.mpg.de/english/kontakt.htm"
 onmouseover="SpaltenFaerben('#C9DBD8','imprint')"
 onmouseout="SpaltenFaerben('#e6f2f2','imprint')" onfocus="this.blur()"
 class="metanavi"><img src="../bilder/pixel.gif" alt="Imprint" border="0"
 height="1" width="10">Imprint<img src="../bilder/pixel.gif" alt=""
 border="0" height="8" width="10"></a></td>
                </tr>
              </tbody>
            </table>
            </td>
            <td bgcolor="#e6f2f2"><img src="../bilder/pixel.gif" alt=""
 border="0" height="15" width="1"></td>
            <td width="1"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="1"></td>
            <td bgcolor="#7ca6a6" width="4"><img src="../bilder/pixel.gif"
 alt="" border="0" height="15" width="1"></td>
          </tr>
          <tr>
            <td colspan="10" height="21"><img src="../bilder/pixel.gif"
 alt="" border="0" height="21" width="1"></td>
          </tr>
        </tbody>
      </table>
<!-- /Metanavigation -->
<!-- Kopfzeile -->
      <table bgcolor="#ffffff" border="0" cellpadding="0"
 cellspacing="0" width="100%">
        <tbody>
          <tr>
            <td height="89" width="8"><img src="../bilder/pixel.gif" alt=""
 border="0" height="89" width="8"></td>
            <td valign="top" width="135"><a href="http://www.mpg.de"
 target="_top" onmouseover="SpaltenFaerben('#C9DBD8','mpi')"
 onmouseout="SpaltenFaerben('#e6f2f2','mpi')" title="MPI"><img
 src="../bilder/minerva_logo.gif" alt="MPI"
 style="border: 0px solid ; width: 135px; height: 75px;"></a></td>
            <td width="56"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="56"></td>
            <td align="left" valign="top"><img
 src="../bilder/webLogoStandard_LE.gif" alt="MPI EVAN"
 style="width: 312px; height: 89px;"></td>
            <td width="5"><img src="../bilder/pixel.gif" alt="" border="0"
 height="1" width="5"></td>
          </tr>
          <tr>
            <td colspan="5" height="1"><img src="../bilder/pixel.gif"
 alt="" border="0" height="1" width="1"></td>
          </tr>
        </tbody>
      </table>
<!-- end Kopfzeile -->
<!-- Rahmen fÃ¼r Hauptnavigation, Sub-Navigation, Inhalte -->
      <table bgcolor="#ffffff" border="0" cellpadding="0"
 cellspacing="0" height="100%" width="770">
        <tbody>
          <tr align="center">
            <td background="../bilder/punktlinie_r.gif" height="100%"
 valign="top" width="5"><br>
            </td>
<!-- Platzhalter zwischen Hauptnavigation und Inhalt -->
<!-- end Platzhalter --><!-- start Subnavigation und Inhalte --><td
 valign="top" width="100%">
            <table style="width: 817px; height: 43px;" border="0"
 cellpadding="0" cellspacing="0">
              <tbody>
                <tr>
                  <td bgcolor="#7ca6a6" height="20" width="100%"><img
 src="../bilder/pixel.gif" alt="" border="0" height="1" width="10"><span
 class="headlineNavi"><a href="http://www.eva.mpg.de/genetics/" target="_top" class="headlineNavi">Department&nbsp; of Genetics</a> / <a href="../index.html" target="_top" class="headlineNavi">Bioinformatics Group</a> / Ibis - Improved base identification system<br>
                  </span></td>
                </tr>
              </tbody>
            </table>
<!-- / HEADLINE und SUBNAVIGATION --> <img src="ibis_shadow_left.png" height="40" width="38" alt="Ibis"> &nbsp; <img src="../bilder/webbanner.jpg"
 alt="Webbanner MPI Leipzig" height="40" width="566"> &nbsp; <img src="ibis_shadow_right.png" height="40" width="38" alt="Ibis">
 <!-- CONTENT  -->
            <table border="0" cellpadding="0" cellspacing="1" width="100%">
              <tbody>
	      <tr>
                 <td bgcolor="#7ca6a6" height="20" width="30%" align="center"><img
		 src="../bilder/pixel.gif" alt="" border="0" height="1" width="10"><span
		 class="headlineNavi">General<br></span></td>
                 <td bgcolor="#7ca6a6" height="20" width="30%" align="center"><img
		 src="../bilder/pixel.gif" alt="" border="0" height="1" width="10"><span
	         class="linkBlack"><a href="manual.html" target="_top">Manual</a><br></span></td>
                 <td bgcolor="#7ca6a6" height="20" width="40%" align="center"><img
		 src="../bilder/pixel.gif" alt="" border="0" height="1" width="10"><span
	         class="linkBlack"><a href="download.html" target="_top">Download and Installation</a><br></span></td>
               </tr>
	      </tr>
	      </tbody>
	    </table>
            <table border="0" cellpadding="0" cellspacing="0" width="100%">
              <tbody>
                <tr>
                  <td>
                  <table bgcolor="#ffffff" border="0" cellpadding="0"
 cellspacing="0" height="10" width="566">
                  <tbody>&nbsp;</tbody>
		  </table>
		  </td>
		</tr>
<tr><td>
<h1 align="center" style="font-size:12px">News and Updates</h1>

<p><i>All software provided on this website comes without any warranty, use it at your own risk.</i></p><br>

<p><i>October 6 2010:</i> Ibis 1.1.5 is available for <a href="ibis_1.1.5.tgz">download</a>. The new version of Ibis comes with two small bug fixes: (1) training failing for single read runs with index reads when using QSEQ as input (broke with the BCL update), (2) when the training data is sorted by coordinates sort was using the system default temp folder instead of the user defined temp folder.</p>

<p><i>September 12 2010:</i> Ibis 1.1.4 is available for <a href="ibis_1.1.4.tgz">download</a>. This is version of Ibis comes with BCL support, allowing it to directly read the base calls from the folder the instrument copies to network without an additional qseq conversion step. This version has not been tested thoroughly.</p>

<p><i>July 30 2010:</i> Ibis 1.1.3 is available for <a href="ibis_1.1.3.tgz">download</a>. This is a minor version update and therefore not announced via email. This version implements an additional checking for read length parameters and allows to base call a subset of all cycles available (i.e. leaving out cyles at the end of the run).</p>

<p><i>June 7 2010:</i> Ibis 1.1.2 is available for <a href="ibis_1.1.2.tgz">download</a>. With this version we cleaned up some code in the training routines - increasing the speed for indexed (multiplex) sequencing runs. We also allow to restrict the reads used in training/testing to a specific index sequence (useful for runs using a spike-in PhiX with a specific index in all lanes, without this new filter the PhiX reads can only be identified by the alignment to the reference). Further, support for bowtie [7] was added. Now the training/test data set can also be created from bowtie alignments, however using a small genome like PhiX there is no gain in speed here (bowtie is even slower). Thus, this functionality is only useful if no control reads are available and the training has to be based on alignments to a large (e.g. mammalian) reference (see also the comment in our <a href="manual.html" target="_top">Manual</a> about side effects/problems of this approach).</p>

<p><i>March 9 2010:</i> Ibis 1.1.1 is available for <a href="ibis_1.1.1.tgz">download</a>. With this version we cleaned up and rewrote some code in the prediction routine. We also fixed some memory leaks caused by the interaction with the SVM package that we are using. As a result this new version requires less memory in the prediction step - important for runs with a high number of cycles and when working on CIF input files. <i>Minor change of output files:</i> In contrast to earlier versions, in the FastQ output the header of the sequence is no longer repeated for the quality score line to reduce the file size.</p>

<p><i>February 2 2010:</i> Ibis 1.1.0 is available for <a href="ibis_1.1.0.tgz">download</a>. This version now supports all three different cluster coordinate conversions performed for the different pipeline and RTA versions (for details see the manual page at the very bottom). Please do not forget to define the new flag with every Ibis call as otherwise Ibis assumes the conversion performed by OLB 1.6.0 / RTA 1.6. This new version also comes with some changes in the python wrapper scripts. The collection of sequences for the training data set is now also using multiple cores and the prediction routine does an internal memory check (hopefully preventing system crashes due to an out of memory when running multiple processes on large sequencing runs).</p>

<p><i>January 20 2010:</i> A new version of the Illumina processing pipeline (OLB 1.6.0 / RTA 1.6) has been released recently. Due to the different transformation of cluster coordinates to sequences identifiers, the current version of Ibis will not work correctly with its output files. We will release a new version of Ibis soon.</p>

<p><i>January 5 2010:</i> Ibis 1.0.9 is available for <a href="ibis_1.0.9.tgz">download</a>. This version comes with a bug fix for the auto detection of read lengths in the training process. When auto detection was used, the earlier version crashed in the training process with "ValueError: invalid literal for int() with base 10: 'None'".</p>

<p><i>December 16 2009:</i> Ibis 1.0.8 is available for <a href="ibis_1.0.8.tgz">download</a>. This version comes with optimized code for creating the training/test data set from CIF files - which is considerably faster (more than a factor of 100 in a test case) for extracting a small number of clusters from many tiles. It also fixes a small bug with the correct propagation of index read length in combination with the presence of key sequences (probably something which is not used by many people). Another thing that changed: I realized that only 1/4 of the training/test sequences was actually used for training and testing when working on RTA output folders (pos + CIF + qseq files). The problem seems to be a different implementation of how image coordinates in the position files are handled: with earlier IPAR/Pipeline versions these were rounded before conversion to integer, in the new version floor and abs is used before conversion. The current Ibis version now applies these different rounding strategies depending on whether CIF files are used as input or not (which probably is only a heuristic way of differentiating the different strategies implemented by Illumina).</p>

<p><i>October 7 2009:</i> Ibis 1.0.7 is available for <a href="ibis_1.0.7.tgz">download</a>. This version comes with some small bug fixes: (1) Explicit include of limits library in C++ source, (2) Reading qseq files created by RTA with an additional tab separator at the end of each line, (3) Reading reference fasta files with additional white space lines, (4) Deducing Firecrest/Intensities path from given relative Bustard path when the current working directory is the Bustard/BaseCalls folder, (5) An additional option for runBaseCalling.py (--NoFinishCheck) to turn off checking for the s_[1-8]_finished.txt files, which are missing in unpacked SRF files and RTA folders. Thanks to everyone for reporting problems! </p>

<p><i>October 5 2009:</i> When unpacking a run folder from a SRF file or using the BaseCalls folder from RTA as input for Ibis, runBaseCalling.py fails with the message "Need path to finished bustard folder. The given folder is incomplete.". At the end of the <a href="manual.html" target="_top">Manual section</a> you can find a work-a-round for this problem.</p>

<p><i>September 30 2009:</i> Thanks to everyone for the positive feedback at the German Conference on Bioinformatics (GCB) meeting in Halle (Saale). You may download the <a href='poster_CSH-BOG_ISMBECCB.pdf'>poster</a> (also shown at the Cold Spring Harbor Biology of Genomes Meeting and the ISMB/ECCB meeting) as well as the <a href='poster_update_gcb.pdf'>update information</a> on recent chemistries/training without PhiX.</p>

<p><i>August 27 2009:</i> On some systems the pthreads library used by SOAP seems to cause problems. In these cases SOAP crashes without creating a training data set, causing Ibis to fail. In the <a href="download.html" target="_top">download section</a> you can find some more details on this problem.</p>

<p><i>August 17 2009:</i> Ibis 1.0.6 is available for <a href="ibis_1.0.6.tgz">download</a>. This version comes with very minor updates, one affecting the better distribution of jobs over several CPUs and an other fixing that the first sequence in the training data set extracted had wrong image coordinates.</p>

<p><i>August 14 2009:</i> Ibis was accepted for publication by <a href="http://genomebiology.com/2009/10/8/R83" target="_new">Genome Biology</a>.</p>

<p><i>July 23 2009:</i> Ibis 1.0.5 is available for <a href="ibis_1.0.5.tgz">download</a>. With the last Ibis version, the processing of the example provided failed due to missing prb files. The new version does not require these files. There has also been a change for calling N bases. In this version Ibis calls Ns in case that all four intensities of the cycle where exactly zero. This happens more often with the new pipeline failing to register images between cycles. Calling Ns shall allow the users to identify such cases from the base calling results.</p>

<p><i>June 30 2009:</i> Thanks to everyone for the positive feedback at the ISMB/ECCB meeting. You may download the <a href="flyer_IlluminaUserMeeting.pdf">flyer</a> (first distributed at the European Illumina User Meeting in April) and the <a href='poster_CSH-BOG_ISMBECCB.pdf'>poster</a> (shown at the Cold Spring Harbor Biology of Genomes Meeting and the ISMB/ECCB meeting).</p>

<p><i>June 28 2009:</i> Ibis 1.0.4 is available for <a href="ibis_1.0.4.tgz">download</a>. There have been a few minor changes to further adapt to Analysis Pipeline 1.4 (recognizing Bustard input data where the index and the two PE reads have been separated into three files, reading CIF files only for the sub read specified in the prediction step, ...). Additionally, the work-around using SOAP v2 for longer reads is no longer necessary and no longer available, as the script for training data extraction now automatically splits up and later merges long reads.</p>

<p><i>May 26 2009:</i> There was a minor bug in the uploaded Ibis 1.0.3 version causing runBascalling.py to fail in the last step. A corrected version has been uploaded.</p>

<p><i>May 25 2009:</i> Ibis 1.0.3 is available for <a href="ibis_1.0.3.tgz">download</a>. This version now supports the new binary intensity file format (CIF) which is created by the RTA module of Genome Analyzers with SCS2.4 and supported by the Illumina Analysis Pipeline 1.4.</p>

<p><i>May 20 2009:</i> Ibis 1.0.2 is available for <a href="ibis_1.0.2.tgz">download</a> now. This version fixes a problem that was introduced in version 1.0.1. When using IPAR intensity files as input for multi-read runs (Paired End/Index reads), version 1.0.1 did extract wrong intensities for the training of the models, causing the bases called for the Paired read to be completely off (reflected by very low quality scores).</p>

<p><i>If you would like to be informed by email in case an update/bugfix for Ibis gets available, please send an email to ibis (at) eva.mpg.de.</i></p><br>

<h1 align="center" style="font-size:12px">From intensities to base calls: Ibis - Improved base identification system for the Illumina Genome Analyzer</h1>

<br><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;What is Ibis?</h2>

Ibis (Improved base identification system), is an accurate, fast and easy-to-use base caller for the Illumina sequencing system, which significantly reduces the error rate and increases the output of usable reads. Ibis is faster and makes fewer assumptions about chemistry and technology. It outperforms other public available base calling packages such as AltaCyclic [1] and Rolexa [2].

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;How does Illumina sequencing work?</h2>

The Genome Analyzer (GA) by Illumina Inc. [3] is based on parallel fluorescence-based readout of millions of immobilized sequences which are iteratively sequenced using reversible terminator chemistry. For sequencing, up to eight DNA libraries with special adapter sequences on the 3' and 5' end are hybridized to an 8-lane flow cell. In each of the lanes, single stranded library molecules hybridize to complementary oligos which are covalently bound to the flow cell surface. Using the double stranded duplex, the reverse strand of each library molecule is synthesized. Starting from the now covalently bound reverse strand, each molecule is then further amplified in a process called bridge amplification. This creates clusters each containing more than 1000 copies of the starting molecule. Using modifications in the oligo sequences one strand is selectively removed. Subsequently, free ends are blocked and a sequencing primer is annealed onto the adapter sequences of the cluster molecules.  Starting from the sequencing primers, 3' terminated and fluorescence-labeled nucleotides are incorporated using a special polymerase. The base incorporation immediately stops after one base due to the 3' termination of the nucleotides. The fluorophores attached to the nucleotides are illuminated using a red and a green laser and imaged through different filters, totaling in four images per tile. The number of tiles varies depending on the specific setup of the Genome Analyzer, for Genome Analyzer I it is typically 300 tiles per lane, for Genome Analyzer II it is 100 tiles per lane. After an imaging cycle, the fluorescent labels as well as the 3' terminator are chemically removed and the next incorporation cycle is started. Incorporation and imaging cycles are repeated up to a designated number of cycles, defining the read length for all clusters.

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;What happens with the images created by the Genome Analyzer?</h2>

The image analysis software of the IPAR (Integrated Primary Analysis and Reporting) machine, the RTA (Real-Time Analysis) on the Genome Analyzer PC or the Firecrest program of the Genome Analyzer Pipeline registers the four images, which are slightly scaled and shifted due to the different filters used, and identifies the clusters in the images. The images are then further registered between cycles and the intensity values extracted from the four images for each of the clusters identified. This results in four floating point numbers per clusters and cycle. A cluster is identified by the quadruple of lane number, tile number and x-y coordinates of the cluster in the superimposed reference image. 

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;How does the standard base calling work for the Illumina Genome Analyzer systems?</h2>

The intensities values extracted in the image analysis are the actual input for the base calling on Illumina system. Due to technical and chemical limitations these intensities show the following two main effects which have to be considered in the base calling process:<p> 

(1) A strong correlation of the A and C intensities as well as of the G and T intensities due to similar emission spectra of the fluorophores and limited separation by the filters used. <p>

(2) Dependence of the signal of a specific cycle by the signal of the cycles before and after, called phasing and pre-phasing respectively. Phasing and pre-phasing are caused by incomplete removal of the 3' terminators and fluorophores, sequences in the cluster missing an incorporation cycle, as well as by the incorporation of nucleotides without effective 3' terminators. <p>

The Illumina base caller (Bustard) uses a so-called crosstalk matrix estimated from the first and second imaging cycle to orthogonalize the correlated channels. Further this matrix is used to scale the different intensities measured for each of the fluorophores. The estimation of the crosstalk matrix is based on the assumption that the four nucleotides are almost equally frequent in the library being sequenced. If the sample does not fulfill this assumption this estimate can be inaccurate and lead to incorrect base calling. Bustard estimates the phasing and pre-phasing as two channel-independent parameters from the increasing correlation of intensities in the first few cycles of the sequencing run. Using the crosstalk matrix and the two phasing parameters, it creates corrected intensity values and calls the base with the highest corrected intensity for each cluster and cycle. In the case of equal intensity values or small intensity differences an N is called.

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;Why is the standard base calling imperfect?</h2>

The Bustard base calling uses a specific model of the sequencing process for estimating and correcting the raw intensity values extracted from the images. There are at least two effects observed in the intensities that Bustard does not explicitly model/correct for: <p>

(1) Decreasing intensity values over the course of the run, due to the degradation of the fluorophores, or the effect of a decreasing number of sequences being elongated in each cluster when nucleotides for which the termination cannot be removed are incorporated. <p>

(2) Unequal effects of phasing for the four nucleotides (e.g. T accumulation in chemistries FC-104-100x or FC-204-20xx due to a lower removal rate of T fluorophores).<p>

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;Why is Ibis better and faster then other approaches?</h2>

The reason for the better performance of Ibis is its model independent training process, which only relies on the assumption that the vast majority of the signal needed for base calling is captured by the intensity values of the last, the current and the next cycle and learning everything else using a training data set and a statistical learning approach. All other base callers published (i.e. Bustard, AltaCyclic and Rolexa) use a specific model of the sequencing process for estimating and correcting the raw intensity values extracted from the images before base calling. If their models are incomplete or model assumptions not fulfilled, their results are imperfect. 

<br>The gain in speed compared to packages like AltaCyclic or Rolexa is due to the fast extraction of a training data set using the fast mapping tool SOAP v1.11 [4] and the utilization of a fast Support Vector Machine (SVM) package. For the SVM classifiers of each cycle, we use the computational fast implementation of multiclass SVMs with polynomial kernels by Thorsten Joachims, called SVMmulticlass [5].

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;Is Ibis only useful for runs showing T accumulation? How does it work with the new chemistry?</h2>

Even though Ibis has been developed to handle the T accumulation in a sequencing chemistry which has been replaced by a new version (FC-103-300x), its application is not limited to the reprocessing of data created with the older chemistries (FC-104-100x or FC-204-20xx). We could show that Ibis is able to even improve the output of sequencing runs from the Genome Analyzer I, which due to their short read length are barely affected by T accumulation but by a generally lower image and sequencing quality. The reason is the model independent training process of Ibis, which only relies on the assumption that the vast majority of the signal needed for base calling is captured by the intensity values of the last, the current and the next cycle. From experiments with the newer sequencing chemistries (including tests with a new polymerase used in the sequencing process), we see that, especially for long reads, there is an advantage in using Ibis for all chemistries and version of the Genome Analyzer platform.

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;Which input files does Ibis need? How does it work?</h2>

There are three different file formats storing intensity values and cluster identifiers depending on the analysis pipeline version used. Each of them can be the input of the base calling process, however Ibis does not support a mixture of different file formats provided: <p>

(1) The format created by the IPAR software stores the intensity values in one file per lane and tile with the four intensities values of a cluster per line and #-comment lines separating the different cycles. The coordinates for each cluster are saved one per line in the very same order in a corresponding idx-file or pos-file depending on the exact SCS-version and GA Pipeline version. <p>

(2) The format created by the Firecrest program stores the same information per lane and tile in one file starting with the identifying quadruple at the beginning and each four intensity values of one cycle separated by space and the cycles separated by tabulator in one line per cluster. <p>

(3) The binary CIF format and the corresponding pos-files created by RTA (GA analysis pipeline 1.4 and higher). <p>

In addition to the intensity files, Ibis also needs a training data set, which can be created from the Bustard base calling results. Here fore, Ibis extracts raw sequences from the Bustard folder of the sequencing run, which depending on the Genome Analyzer Pipeline version, are either available as bcl files, qseq files or seq files. For a fraction of the tiles, the Bustard raw reads are aligned to the corresponding reference (in general PhiX 174 RF1) using the fast mapper SOAP v1.11 [4]. For each mapped sequence, the sequence of the reference is considered to be the correct and the raw intensity values of the previous, the current and the next cycle are extracted from the intensity files. For each cycle/position of the read one multiclass support vector machine model is trained. These models are later applied to the data of the complete run using a new C++ interface to the SVMmulticlass package. This program then creates for each cluster in the intensity files an entry in a FastQ file containing the sequence and PHRED-like quality scores in the Sanger encoding (offset 33).

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;What are the technical requirements for Ibis? With which versions of the Genome Analyzer pipeline does it work?</h2>

Ibis is based on Python scripts (tested with 2.5.2) and C++ programs (including the SVMmulticlass package) and runs on normal x86 architectures. Multi-core systems are recommended but not needed. The training process creates big temporary files (depending on the read length and size of the sequencing run up to several gigabytes) but typically needs little RAM (< 500 MB). The final models used for prediction are typically smaller than 5 MB in total. In the final base calling step, several prediction instances can be started in parallel on multi-core systems - depending on the number of cycles, per instance about 500 to 2000 MB of RAM are needed. Ibis has been tested on Illumina pipeline versions 0.3.0, 1.0, 1.3.2 and 1.4.0. Recently, Illumina showed that it is possible to port their pipeline to Microsoft Windows systems using cygwin. We have not tested to do the same with Ibis, however with an appropriate cygwin installation, the <a href="download.html" target="_top">installation procedure</a> should directly apply for Windows systems.

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;What kind of license does apply for Ibis? Is it free to use?</h2>

Even though distributed as one package, the source distributed as the Ibis package applies different licences. Among other packages Ibis uses the SVM struct package by Thorsten Joachims. We got the permission to distribute SVM struct and our modification as one Ibis package, however SVM struct is only granted free of charge for non-commercial research and education purposes. So you must obtain a license from the SVM struct author to use it for commercial purposes. In this case please directly contact Thorsten Joachims via his website <a href="http://svmlight.joachims.org" target="_new">http://svmlight.joachims.org/</a>. <p> 
All other parts, i.e. our interface to the SVM struct package (<font style="font-family: monospace">svm_struct_classify_firecrest.cpp</font>), the Python scripts as well as SOAP v1.11 apply GPLv3, Gzstream is licensed with GPL v2.3.

<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;Has Ibis been published? What to cite when using it?</h2>

An Ibis manuscript has been published by Genome Biology and is available <a href="http://genomebiology.com/2009/10/8/R83" target="_new">here</a>. The citation line as available from PubMed is:<p>
Kircher M, Stenzel U, Kelso J: <i>Improved base calling for the Illumina Genome Analyzer using machine learning strategies.</i> Genome Biol. 2009 Aug 14;10(8):R83. PMID: 19682367 


<p><h2><img src="../bilder/linkPfeil.gif" alt="link" border="0" height="11" width="9">&nbsp;References:</h2>

1.	Erlich Y, Mitra PP, delaBastide M, McCombie WR, Hannon GJ: <i>Alta-Cyclic: a self-optimizing base caller for next-generation sequencing.</i> Nat Methods 2008, 5(8):679-682.<br>
2.	Rougemont J, Amzallag A, Iseli C, Farinelli L, Xenarios I, Naef F: <i>Probabilistic base calling of Solexa sequencing data.</i> BMC Bioinformatics 2008, 9:431.<br>
3.	Bentley DR, Balasubramanian S, Swerdlow HP, Smith GP, Milton J, Brown CG, Hall KP, Evers DJ, Barnes CL, Bignell HR et al: <i>Accurate whole human genome sequencing using reversible terminator chemistry.</i> Nature 2008, 456(7218):53-59.<br>
4.	Li R, Li Y, Kristiansen K, Wang J: <i>SOAP: short oligonucleotide alignment program.</i> Bioinformatics 2008, 24(5):713-714.<br>
5.	Tsochantaridis I, Joachims T, Hofmann T, Altun Y: <i>Large margin methods for structured and interdependent output variables.</i> Journal of Machine Learning Research 2006, 6(2):1453.<br>
6.	Ewing B, Green P: <i>Base-calling of automated sequencer traces using phred. II. Error probabilities.</i> Genome Res 1998, 8(3):186-194.<br>
7.	Langmead B, Trapnell C, Pop M, Salzberg SL. Ultrafast and memory-efficient alignment of short DNA sequences to the human genome. Genome Biol 10:R25. 

<p>&nbsp;<p>&nbsp;
</td></tr>
              </tbody>
            </table>
            </td>
            <td background="../bilder/punktlinie_l.gif" height="100%"
 valign="top" width="5"><br>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
      <td valign="top" width="50%"><!-- Platzhalter rechts -->
      <table style="background-color: rgb(124, 166, 166); width: 100%;"
 border="0" cellpadding="0" cellspacing="0">
        <tbody>
          <tr>
            <td height="15" width="*"><img src="../bilder/pixel.gif" alt=""
 border="0" height="15" width="1"></td>
          </tr>
          <tr>
            <td bgcolor="#ffffff" height="111"><img
 src="../bilder/pixel.gif" alt="" border="0" height="111" width="1"></td>
          </tr>
          <tr>
            <td height="20"><img src="../bilder/pixel.gif" alt=""
 border="0" height="20" width="1"></td>
          </tr>
          <tr>
            <td
 style="height: 21px; background-color: rgb(124, 166, 166);"><img
 src="../bilder/pixel.gif" alt="" border="0" height="20" width="1"></td>
          </tr>
          <tr>
            <td bgcolor="#7ca6a6" height="1"><img src="../bilder/pixel.gif"
 alt="" border="0" height="1" width="1"></td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>
</body>
</html>
