<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-gb" lang="en-gb" >
<head>
  <base href="http://esbg.gatech.edu/jordan/software/map" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="robots" content="index, follow" />
  <meta name="keywords" content="" />
  <meta name="title" content="ChIP-seq ambiguous tag mapper full" />
  <meta name="author" content="Lee Katz" />
  <meta name="description" content="Jordan Lab" />
  <meta name="generator" content="Joomla! 1.5 - Open Source Content Management" />
  <title>ChIP-seq ambiguous tag mapper full</title>
  <link rel="stylesheet" href="http://esbg.gatech.edu/jordan/plugins/content/slimbox/slimbox.css" type="text/css" />
  <script type="text/javascript" src="/jordan/media/system/js/mootools.js"></script>
  <script type="text/javascript" src="/jordan/media/system/js/caption.js"></script>
  <script type="text/javascript" src="http://esbg.gatech.edu/jordan/plugins/content/slimbox/slimbox.js"></script>


<link rel="stylesheet" href="/jordan/templates/system/css/system.css" type="text/css" />
<link rel="stylesheet" href="/jordan/templates/system/css/general.css" type="text/css" />
<link rel="stylesheet" href="/jordan/templates/rhuk_milkyway/css/template.css" type="text/css" />
<link rel="stylesheet" href="/jordan/templates/rhuk_milkyway/css/blue.css" type="text/css" />
<link rel="stylesheet" href="/jordan/templates/rhuk_milkyway/css/black_bg.css" type="text/css" />
<!--[if lte IE 6]>
<link href="/jordan/templates/rhuk_milkyway/css/ieonly.css" rel="stylesheet" type="text/css" />
<![endif]-->

</head>
<body id="page_bg" class="color_blue bg_black width_medium">
<a name="up" id="up"></a>
<div class="center" align="center">
	<div id="wrapper">
		<div id="wrapper_r">
			<div id="header">
				<div id="header_l">
					<style>
#nbase_header {
position:absolute;
color:#505050;
/*
height:110px;
top:20px;
*/
height:auto;
margin:28px 0 0 40px;
width:90%;
text-align:right;
padding:0px;
top:0px;
left:0px;
float:left;
}

p.nbase_header {
font-family:sans-serif;
font-size:42px;
font-weight:bold;
line-height:44px;
margin:0;
padding:0;
text-align:right;
}

</style>

<div id="nbase_header">
	<a href="http://www.gatech.edu"><img style="float: left;" src="http://www.gatech.edu/images/logo.gif"></a>
	<p class="nbase_header">Jordan Lab</p>
	<p>Computational Biology and Bioinformatics<br/>
        <a href="http://www.biology.gatech.edu">School of Biology</a>, <a href="http://www.gatech.edu/">Georgia Tech</a><br/>
        </p>
</div>
					<div id="header_r">
						
					</div>
				</div>
			</div>

			<div id="tabarea">
				<div id="tabarea_l">
					<div id="tabarea_r">
						<div id="tabmenu">
						<table cellpadding="0" cellspacing="0" class="pill">
							<tr>
								<td class="pill_l">&nbsp;</td>
								<td class="pill_m">
								<div id="pillmenu">
									<ul class="menu"><li class="item1"><a href="http://esbg.gatech.edu/jordan/"><span>Home</span></a></li><li class="item4"><a href="/jordan/people"><span>People</span></a></li><li class="item3"><a href="/jordan/publications"><span>Publications</span></a></li><li class="parent active item6"><a href="/jordan/software"><span>Software</span></a></li><li class="item2"><a href="http://www.facebook.com/pages/Atlanta-GA/Jordan-Lab/23099245131"><span>Photos</span></a></li><li class="item24"><a href="/jordan/links"><span>Links</span></a></li></ul>
								</div>
								</td>
								<td class="pill_r">&nbsp;</td>
							</tr>
							</table>
						</div>
					</div>
				</div>
			</div>

			<div id="search">
				
			</div>

			<div id="pathway">
				
			</div>

			<div class="clr"></div>

			<div id="whitebox">
				<div id="whitebox_t">
					<div id="whitebox_tl">
						<div id="whitebox_tr"></div>
					</div>
				</div>

				<div id="whitebox_m">
					<div id="area">
									

						<div id="leftcolumn">
												</div>

												<div id="maincolumn_full">
													
							<table class="nopad">
								<tr valign="top">
									<td>
										
<table class="contentpaneopen">



<tr>
<td valign="top">
<p><a href="/jordan/software/map"><img src="/jordan/images/stories/jordanlab/chipseq.png" border="0" alt="chipseqthing" width="100" height="100" style="float: left; border: 0; margin: 10px;" /></a></p>
<!--
<p><a href="/jordan/software/14-uncategorized/88-chip-seq" mce_href="/jordan/software/14-uncategorized/88-chip-seq"><br /></a></p>
-->
<p style="margin-top:2em;"><a href="/jordan/software/map"><strong>ChIP-seq ambiguous tag mapper</strong></a> - a Gibbs sampling algorithm for the mapping of ambiguous ChIP-seq sequence tags. A collaboration with the Lunyak laboratory at the Buck Institute for Age Research.</p>
<p> </p>
<p> </p>
<p> </p>

<h1>Downloads</h1>
<ul>
<li><a href="/jordan/downloads/GibbsAM/documentation.pdf" title="documentation.pdf">Documentation</a></li>
</ul>
<h2>Scripts</h2>
<ul>
<li><strong><a href="/jordan/downloads/GibbsAM/gibbsAM.pl">gibbsAM.pl</a></strong> - Scripts used to map ambiguous tags by Gibbs sampling</li>
<li><strong><a href="/jordan/downloads/GibbsAM/format_bowtie_result.pl">format_bowtie_result.pl</a></strong> - Script used to format the output from Bowtie</li>
<li><strong><a href="/jordan/downloads/GibbsAM/get_unique_file.pl">get_unique_file.pl</a></strong> - Script used to organize unique tags using output from format_bowtie_result.pl</li>
</ul>
<h2>Sample Data</h2>
<ul>
<li><strong><a href="/jordan/downloads/GibbsAM/benchmark.zip">benchmark.zip</a></strong> - Files with the real genomic sites for testing</li>
<li><strong><a href="/jordan/downloads/GibbsAM/tag.zip">tag.zip</a></strong> - Files with the short sequence tags</li>
<li><strong><a href="/jordan/downloads/GibbsAM/initial_map.zip">initial_map.zip</a></strong> - Formatted output from Bowtie and files for unique tags.  These files are the input for gibbs_exec.pl.</li>
</ul>
<p> </p>
<h1>Readme</h1>
<p>To run our ambiguous tag mapping program, you need to do tag-to-genome mapping with the program Bowtie first and then re-format the Bowtie output before running our script (see <a href="/jordan/downloads/GibbsAM/documentation.pdf">Documentation</a> and/or parts A-E below).</p>
<p>Alternatively, to test our program you can use the test data we provide  and run the program directly (see <a href="/jordan/downloads/GibbsAM/documentation.pdf">Documenation</a> and/or parts D and E below).</p>
<p> <b>Notice: the scripts were changed and updated on February 16, 2011. Please use the updated version.</b> </p>
<p> </p>
<hr />
<p> </p>
<p>A. Run Bowtie program to obtain the initial mapping of sequence tags.<br /><br />B. Format the output from Bowtie program:<br /> 1. The output file from Bowtie program need to be formatted in order to run “gibbsAM.pl”.<br /> 2. Run the script “format_bowtie_result.pl” to change the format.<br /> 3. Command line:</p>
<pre> perl format_bowtie_result.pl –p directory –i Bowtie output file -o output.bed<br /><br /> -p:  directory where the Bowtie output file (initial mapping of tags) is located;</pre>
<pre> -i:  the Bowtie output file (initial mapping of tags), including both unique and ambiguous tags;</pre>
<pre> -o:  the name of the output file. The default name is “mapping_result.bed”</pre>
<p>4. The resulting output file is in this format: “tag_id   chr>position>strand,chr>position>strand,…”<br /> e.g.<br /> HWI-EAS229_75_30DY0AAXX:4:1:0:1282/1    chr18>6452262>+,<br /> HWI-EAS229_75_30DY0AAXX:4:1:0:1282/2    chr18>6452351>+,chr4>66122359>-,<br /><br />C. Organize unique tags:<br /> 1. In order to set the parameters for the algorithm, the unique tags need to be organized.<br /> 2. Run “get_unique_file.pl” to organize the unique tags.<br /> 3. Command line:</p>
<pre> perl get_unique_file.pl -p directory -i the formatted mapping file -o output.bed -l length of adjacent region   </pre>
<pre> -p:  directory where the formatted mapping file is located   </pre>
<pre> -i:  the formatted mapping file generated by “format_bowtie_result.pl”  </pre>
<pre> -o:  name of output file, the default name is "unique_screen_result.bed"</pre>
<pre> -l:  length of adjacent region for co-located tags, the default value is 147</pre>
<p>4. The resulting output file has this format:<br /> “chr     position_start      position_end        unique_tag_count”<br /> e.g. <br /> chr1    795260    795406    226<br /> chr1    830067    830213    166<br /><br />D. Run "gibbsAM.pl":<br /> 1. After the preparation through the steps above, run “gibbsAM.pl” to apply the Gibbs sampling method to assign <br /> each ambiguous tag to a specific genomic site.<br /> 2. Command line:</p>
<pre> perl gibbsAM.pl -p path -f mapping_result.file -u unique_mapping.file -o output.bed -l region_length <br />     -r maximal_tag_number -a ambiguous_confidence -m iteration_number<br /><br /> -p:  the directory where the files (formatted mapping file &amp; the file for unique tags) are located.</pre>
<pre> -f:  the formatted mapping file generated by “format_bowtie_result.pl”.</pre>
<pre> -u:  the file for unique tags generated by “get_unique_file.pl”.</pre>
<pre> -o:  name of the output file.</pre>
<pre> -l:  the length of the adjacent region for co-located tags. The default value is 147.</pre>
<pre> -r:  the maximal tag count used to construct the likelihood table. The default value is 50.</pre>
<pre> -a:  the relative confidence of ambiguous tags. The default value is 0.2.</pre>
<pre> -m:  the number of iterations. The default value is 5.</pre>
<br />E: Sample Data<br />
<ol>
<li>The sample data are the libraries we used to evaluate the algorithm  performance.</li>
<li>“benchmark.zip”: files with the real genomic sites in the benchmarks.   It contains 2 files. <br /> “benchmark_8lib.bed” is the benchmark for the 8  smaller sequence libraries and “benchmark_biglib.bed” is for the bigger  library.</li>
<li>“tag.zip”: files with the short sequence tags. There are 9 files inside  the folder. “tag_lib*.fastq” are tags for the 8 smaller <br /> libraries  respectively.  “tag_biglib.fastq” is the file with tags for the bigger  library.</li>
<li>“initial_map.zip”: contains <ol>
<li>“mapping_result_lib*.bed” &amp; “mapping_result_biglib.bed”: the  formatted files (generated by “format_bowtie_result.pl”) with initial  mapping results from Bowtie program; </li>
<li>“unique_screen_result_lib*.bed” &amp; “unique_screen_result_biglib.bed”:  the files for unique tags (generated by “get_unique_file.pl”).</li>
</ol></li>
<li>In order to test the algorithm, files in “initial_map.zip” are enough.  If you want to make sure the initial mappings are correct, you can run  Bowtie on files in “tag.zip” and then run “format_bowtie_result.pl” and  “get_unique_file.pl”.</li>
<li>Files in the “benchmark.zip” could be used to compare the final map of  tags to evaluated the performances.</li>
</ol></td>
</tr>

</table>
<span class="article_separator">&nbsp;</span>

										
									</td>
																	</tr>
							</table>

						</div>
						<div class="clr"></div>
					</div>
					<div class="clr"></div>
				</div>

				<div id="whitebox_b">
					<div id="whitebox_bl">
						<div id="whitebox_br"></div>
					</div>
				</div>
			</div>

			<div id="footerspacer"></div>
		</div>

		<div id="footer">
			<div id="footer_l">
				<div id="footer_r">
					<p id="syndicate">
						Maintained by Jay Humphrey at the <a href="http://www.biology.gatech.edu">School of Biology</a>, <a href="http://www.gatech.edu">Georgia Institute of Technology</a>
					</p>
					<p id="power_by">
	 				 	
					</p>
				</div>
			</div>
		</div>
	</div>
</div>


</body>
</html>
